<ng-container *ngIf="!isCustomerLoggedIn">
  <div class="rpo-Company rpo-component">
    <div class="filter-tabs-area">
      <div class="tabs">
        <ul>
          <li (click)="tabChange('company')" [class]="ShowCompany ? 'active' : ''">
            <a>Company</a>
          </li>
          <li (click)="tabChange('rfp')" [class]="ShowRFP ? 'active' : ''">
            <a>Proposals</a>
          </li>
          <li (click)="tabChange('jobs')" [class]="ShowJobs ? 'active' : ''">
            <a>Projects</a>
          </li>
        </ul>
      </div>
    </div>
    <div class="row component-header">
      <div class="col-sm-12">
        <ul class="breadcrumb rfp-bread pull-left mr-2">
          <li>
            <small (click)="getBack()">
              <a rel='noreferrer' class="pointer" routerLink="/contacts">Contacts</a>
            </small>
          </li>
          <li>
            <a>Contact Detail</a>
          </li>
        </ul>

        <div class="search middle pull-left">
          <div class="inner-addon left-addon">
            <i class="icon fa fa-search" *ngIf="ShowRFP || ShowJobs"></i>
            <input type="text" class="form-control" *ngIf="ShowRFP" placeholder="Search Proposal"
              [(ngModel)]="queryString" />
            <input type="text" class="form-control" *ngIf="ShowJobs" placeholder="Search Project"
              [(ngModel)]="queryString" />
          </div>
        </div>
        <button type="button" *ngIf="ShowCompany" class="btn btn-panel pull-right middle {{showCompanyAddBtn}}"
          (click)="openModal(formCompany)">Edit Company</button>
        <button type="button" *ngIf="ShowRFP" class="btn btn-panel pull-right middle {{showRfpAddBtn}}"
          (click)="GoToRfp()">Add Proposal</button>
        <button type="button" *ngIf="ShowJobs" class="btn btn-panel pull-right middle {{showJobAddBtn}}"
          (click)="openJobModal(formJob,company.id,rec.id)">Add Project</button>
      </div>
    </div>

    <!-- CONTACT CARD -->
    <div class="component-body">

      <div class="col-sm-3 contact-card">
        <div>
          <div class="panel panel-default panel-contact main-card">
            <div class="panel-heading panel-heading-contactDetail">
              <div class="row">
                <div class="col-sm-12">
                  <div class="user-icon" style="background-image: url('{{rec.imageAux}}');">
                    <!-- <img src="{{rec.imageAux}}" /> -->
                  </div>
                  <div class="user-info">
                    <p class="p-contactTitle">
                      <span *ngIf="!rec.isActive"><i class=" incative-color fa fa-exclamation-circle"
                          aria-hidden="true"></i>
                      </span>
                      <span *ngIf="rec.isActive"><i class="active-color fa fa-check-circle" aria-hidden="true"></i>
                      </span>


                      {{join([rec.prefix, (' ')], "") + join([rec.firstName, rec.middleName, rec.lastName, rec.suffix], ")
                        ")}}
                    </p>
                    <p class="p-contactTitle">
                      {{rec.contactTitle ? rec.contactTitle : ''}}
                    </p>
                    <div *ngIf="rec.companyAddresses?.length > 0">
                      {{rec.companyAddresses[0].addressType?.name}}] {{join([rec.companyAddresses[0].address1,
                        rec.companyAddresses[0].address2])}}
                      <br /> {{join([rec.companyAddresses[0].city,
                        rec.companyAddresses[0].state, rec.companyAddresses[0].zipCode])}}
                      <br />{{rec.companyAddresses[0].phone? rec.companyAddresses[0].phone : '-'}}
                    </div>
                    <div *ngIf="rec.companyAddresses?.length == 0 && rec.addresses?.length > 0">
                      {{rec.addresses[0].addressType?.name}}] {{join([rec.addresses[0].address1,
                        rec.addresses[0].address2])}}
                      <br /> {{join([rec.addresses[0].city, rec.addresses[0].state, rec.addresses[0].zipCode])}}
                      <br />{{rec.addresses[0].phone? rec.addresses[0].phone : '-'}}
                    </div>
                  </div>
                  <span dropdown-widget [items]="this.contactWidgetItems"
                    (onItemClick)="onContactWidgetItemClick($event,formContact)"
                    class="company-widget pull-right"></span>
                  <span dropdown-widget *ngIf="!rec.isActive" dropdown-widget [items]="this.inActivecontactWidgetItems"
                    (onItemClick)="onContactWidgetItemClick($event,formContact)"
                    class="company-widget pull-right"></span>
                </div>
              </div>

            </div>
            <div class="panel-body">
              <!-- CONTACT DETAIL BLOCK -->
              <div class="row">
                <div class="col-sm-12">
                  <span class="label-card">Contact Detail</span>
                </div>
              </div>
              <div class="row">
                <div class="col-sm-3">
                  <span class="span-label-card-other">Work:</span>
                </div>
                <div class="col-sm-8">
                  <span class="span-label-card-other1">{{rec.workPhone ? rec.workPhone: '-'}} {{rec.ext !=null &&
                    rec.ext !='' ? '+':''}} {{rec.ext ? rec.ext :
                    ''}}</span>
                </div>
              </div>
              <div class="row">
                <div class="col-sm-3">
                  <span class="span-label-card-other">Mobile:</span>
                </div>
                <div class="col-sm-8">
                  <span class="span-label-card-other1">{{rec.mobilePhone ? rec.mobilePhone : '-'}}</span>
                </div>
              </div>
              <div class="row">
                <div class="col-sm-3">
                  <span class="span-label-card-other">Other:</span>
                </div>
                <div class="col-sm-8">
                  <span class="span-label-card-other1">{{rec.otherPhone!= '' && rec.otherPhone!= null ? rec.otherPhone :
                    '-'}}</span>
                </div>
              </div>
              <div class="row">
                <div class="col-sm-3">
                  <span class="span-label-card-other">Email:</span>
                </div>
                <div class="col-sm-9">
                  <a class="span-label-card-other1 link-blue" rel='noreferrer' href="mailto:{{rec.email}}">{{rec.email ?
                    rec.email : '-'}}</a>
                </div>
              </div>
              <div *ngIf="rec.addresses?.length > 1">
                <div class="row" *ngFor="let item of rec.addresses| slice:1; let i = index;">
                  <div class="col-sm-3">
                    <span class="span-label-card-other">{{item?.addressType?.name}}:</span>
                  </div>
                  <div class="col-sm-9">
                    <span class="span-label-card-other1" *ngIf="rec.addresses?.length > 0">{{join([item.address1,
                        item.address2])}}
                      <br /> {{join([item.city, item.state, item.zipCode])}}
                      <br />{{item.phone? item.phone : ''}}</span>
                  </div>
                </div>
              </div>
              <div
                *ngIf="rec.addresses?.length == 1 && (rec.companyAddresses?.length == 0 || rec.companyAddresses?.length > 0)">
                <div class="row" *ngFor="let item of rec.addresses; let i = index;">
                  <div class="col-sm-3">
                    <span class="span-label-card-other">{{item?.addressType?.name}}:</span>
                  </div>
                  <div class="col-sm-9">
                    <span class="span-label-card-other1" *ngIf="rec.addresses?.length > 0">{{join([item.address1,
                        item.address2])}}
                      <br /> {{join([item.city, item.state, item.zipCode])}}
                      <br />{{item.phone? item.phone : ''}}</span>
                  </div>
                </div>
              </div>


              <br />

              <!-- OTHER INFORMATION BLOCK -->
              <div class="row" *ngIf="rec.contactLicenses?.length > 0">
                <div class="col-sm-12">
                  <span class="label-card"> License </span>
                </div>
              </div>
              <div class="row license-data" *ngIf="rec.contactLicenses?.length > 0">
                <div class="col-sm-12" *ngFor="let license of rec.contactLicenses">
                  <div class="lc-type">
                    {{join([license.contactLicenseType.name, license.number], " #")}}
                  </div>
                  <div class="row">
                    <div class="col-sm-6">
                      <span class="span-label-card-other">Expiration Date:</span>
                    </div>
                    <div class="col-sm-6">
                      <span
                        class="span-label-card-other1">{{join([rec.contactLicenses[0].expirationLicenseDate])}}</span>
                    </div>
                  </div>
                </div>
              </div>

              <br />

              <!-- NOTES BLOCK -->
              <div class="row" *ngIf="rec.notes">
                <div class="col-sm-12">
                  <span class="label-card"> Note:</span>
                </div>
              </div>
              <div class="row" *ngIf="rec.notes">
                <div class="col-sm-12">
                  <span class="notes">{{rec.notes}}</span>
                </div>
              </div>
              <div class="modify" *ngIf="rec.lastModifiedByEmployeeName">Last modified by
                {{rec.lastModifiedByEmployeeName}}
                on {{rec.lastModifiedDate | date:'MM/dd/yyyy h:mm a'}}</div>
            </div>
          </div>
        </div>
      </div>

      <!-- TABS -->
      <!-- <div class="col-sm-9 div-no-padding-right-card ">
        <div>
          <tabset class="contactDetailDefined">
            <tab heading="Company" (selectTab)="tabChange('company')" active="true" *ngIf="rec.idCompany != null">
              <div [ngStyle]="{'max-height': detailsGridHeight() + 'px', 'overflow': 'auto', 'margin-top': '15px'}">
                <div class="panel panel-default panel-contact grid-card">
                  <div class="panel-heading panel-heading-contactCompaniesDetail">
                    <div class="row">
                      <div class="col-sm-12">
                        <p class="p-contactTitle">
                          <a rel='noreferrer' href="javascript:void(0)" class="comp-name"
                            (mousedown)='Hola($event, company)'>
                            {{company.name}}
                          </a>
                        </p>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-sm-12" *ngIf="company.addresses?.length > 0">
                        {{join([company.addresses[0].address1, company.addresses[0].address2])}}
                        <br /> {{join([company.addresses[0].city,
                        company.addresses[0].state,company.addresses[0].zipCode])}}
                        <br />{{company.addresses[0].phone? company.addresses[0].phone : '-'}}
                        |{{company.addresses[0].faxNumber? company.addresses[0].faxNumber : '-'}}
                      </div>
                    </div>
                  </div>
                  <div class="panel-body">
                    <div class="row">
                      <div class="col-sm-4">
                        <div class="row">
                          <div class="col-sm-12">
                            <span class="label-card">Company Address</span>
                          </div>
                        </div>
                        <div class="row" *ngFor="let item of company.addresses| slice:1; let i = index;">
                          <div class="col-sm-3">
                            <span class="span-label-card">{{item?.addressType?.name}}:</span>
                          </div>
                          <div class="col-sm-9" *ngIf="company.addresses?.length > 0">
                            {{join([item.address1 , item.address2])}}
                            <br /> {{join([item.city, item.state,item.zipCode])}}
                            <br />{{item.phone? item.phone : '-'}} | {{item.faxNumber? item.faxNumber : '-'}}
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-sm-12">
                            <span class="label-card"> Other Information</span>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-sm-5">
                            <span class="span-label-card">Company Type:</span>
                          </div>
                          <div class="col-sm-7">
                            <div *ngFor="let type of company.companyTypes">{{type.itemName}}</div>
                          </div>
                        </div>
                      </div>
                      <div class="col-sm-4">
                        <div class="row" *ngIf="siSelected">
                          <div class="row"
                            *ngIf="company.companyType == companyTypeLayout.specialInspection; else constructorBlockCard">
                            <div class="col-sm-5">
                              <span class="span-label-card">Special Inspector#:</span>
                            </div>
                            <div class="col-sm-7">
                              {{company.specialInspectionAgencyNumber}}
                            </div>
                          </div>
                        </div>
                        <div class="row" *ngIf="gcSelected">
                          <div class="row">
                            <div class="col-sm-5">
                              <span class="span-label-card">Tracking#:</span>
                            </div>
                            <div class="col-sm-7">
                              {{company.trackingNumber}}
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-sm-5">
                              <span class="span-label-card">IBM#:</span>
                            </div>
                            <div class="col-sm-7">
                              {{company.ibmNumber}}
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-sm-5">
                              <span class="span-label-card">Tax ID#:</span>
                            </div>
                            <div class="col-sm-7">
                              {{company.taxIdNumber}}
                            </div>
                          </div>
                          <br />
    
                          <div class="row">
                            <div class="col-sm-12">
                              <span class="label-card"> DOB Insurance/Expiration Date</span>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-sm-5">
                              <span class="span-label-card">Work Compensation:</span>
                            </div>
                            <div class="col-sm-7">
                              {{company.insuranceWorkCompensation}}
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-sm-5">
                              <span class="span-label-card">Disability:</span>
                            </div>
                            <div class="col-sm-7">
                              {{company.insuranceDisability}}
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-sm-5">
                              <span class="span-label-card">General Liability:</span>
                            </div>
                            <div class="col-sm-7">
                              {{company.insuranceGeneralLiability}}
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-sm-12">
                              <span class="label-card"> DOT Insurance/Expiration Date</span>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-sm-5">
                              <span class="span-label-card">DOT Work Compensation:</span>
                            </div>
                            <div class="col-sm-7">
                              {{company.dotInsuranceWorkCompensation}}
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-sm-5">
                              <span class="span-label-card">DOT General Liability:</span>
                            </div>
                            <div class="col-sm-7">
                              {{company.dotInsuranceGeneralLiability}}
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-sm-5">
                              <span class="span-label-card">Street Obstruction Bond:</span>
                            </div>
                            <div class="col-sm-7">
                              {{company.insuranceObstructionBond}}
                            </div>
                          </div>
    
                        </div>
                      </div>
                      <div class="col-sm-4"></div>
                    </div>
    
                    <br />
                    <div class="row">
                      <div class="col-sm-12">
                        <span class="notes"> Note:</span>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-sm-12">
                        {{company.notes}}
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-sm-12 modify" *ngIf="company.lastModifiedByEmployeeName">
                        Last modified by {{company.lastModifiedByEmployeeName}} on {{company.lastModifiedDate |
                        date:'MM/dd/yyyy h:mm a'}}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </tab>
    
            <tab (selectTab)="tabChange('rfp')" heading="Proposal">
              <div class="comp-rfp" *ngIf="ShowRFP">
                <rfp-data-table [contactId]="rec.id"></rfp-data-table>
              </div>
            </tab>
    
            <tab heading="Projects" (selectTab)="tabChange('jobs')">
              <div class="comp-job" *ngIf="ShowJobs">
                <job-data-table [contactId]="rec.id"></job-data-table>
              </div>
            </tab>
            <div class="details-right-block">
              <button type="button" *ngIf="ShowCompany" class="btn btn-panel btn-detail pull-right {{showCompanyAddBtn}}"
                (click)="openModal(formCompany)">Edit Company</button>
              <button type="button" *ngIf="ShowRFP" class="btn btn-panel btn-detail pull-right {{showRfpAddBtn}}"
                (click)="GoToRfp()">Add RFP</button>
              <button type="button" *ngIf="ShowJobs" class="btn btn-panel btn-detail pull-right {{showJobAddBtn}}"
                (click)="openJobModal(formJob,company.id,rec.id)">Add Job</button>
            </div>
          </tabset>
        </div>
      </div> -->

      <div class="col-sm-9 div-no-padding-right-card ">
        <ng-container *ngIf="ShowCompany && rec.idCompany != null">
          <div [ngStyle]="{'padding-left': '1.3%'}">
            <div class="panel panel-default panel-contact grid-card">
              <div class="panel-heading panel-heading-contactCompaniesDetail">
                <div class="row">
                  <div class="col-sm-12">
                    <p class="p-contactTitle">
                      <a rel='noreferrer' href="javascript:void(0)" class="comp-name link-blue"
                        (mousedown)='Hola($event, company)'>
                        {{company.name}}
                      </a>
                    </p>
                  </div>
                </div>
                <div class="row">
                  <div class="col-sm-12" *ngIf="company.addresses?.length > 0">
                    {{join([company.addresses[0].address1, company.addresses[0].address2])}}
                    <br /> {{join([company.addresses[0].city,
                      company.addresses[0].state, company.addresses[0].zipCode])}}
                    <br />{{company.addresses[0].phone? company.addresses[0].phone : '-'}}
                    |{{company.addresses[0].faxNumber? company.addresses[0].faxNumber : '-'}}
                  </div>
                </div>
              </div>
              <div class="panel-body">
                <div class="row">
                  <div class="col-sm-4">
                    <div class="row">
                      <div class="col-sm-12">
                        <span class="label-card">Company Address</span>
                      </div>
                    </div>
                    <div class="row" *ngFor="let item of company.addresses| slice:1; let i = index;">
                      <div class="col-sm-3">
                        <span class="span-label-card-other">{{item?.addressType?.name}}:</span>
                      </div>
                      <div class="col-sm-9">
                        <span class="span-label-card-other1" *ngIf="company.addresses?.length > 0">
                          {{join([item.address1, item.address2])}}
                          <br /> {{join([item.city, item.state, item.zipCode])}}
                          <br />{{item.phone? item.phone : '-'}} | {{item.faxNumber? item.faxNumber : '-'}}
                        </span>
                      </div>
                    </div>
                    <br />

                    <div class="row">
                      <div class="col-sm-12">
                        <span class="label-card"> Other Information</span>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-sm-5">
                        <span class="span-label-card-other">Company Type:</span>
                      </div>
                      <div class="col-sm-7">
                        <div class="span-label-card-other1" *ngFor="let type of company.companyTypes">{{type.itemName}}
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-sm-4">
                    <div class="row" *ngIf="siSelected">
                      <div class="row"
                        *ngIf="company.companyType == companyTypeLayout.specialInspection; else constructorBlockCard">
                        <div class="col-sm-5">
                          <span class="span-label-card-other">Special Inspector#:</span>
                        </div>
                        <div class="col-sm-7">
                          <span class="span-label-card-other1">{{company.specialInspectionAgencyNumber}}</span>
                        </div>
                      </div>
                    </div>
                    <div class="row" *ngIf="gcSelected">
                      <div class="row">
                        <div class="col-sm-5">
                          <span class="span-label-card-other">Tracking#:</span>
                        </div>
                        <div class="col-sm-7">
                          <span class="span-label-card-other1">{{company.trackingNumber}}</span>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-sm-5">
                          <span class="span-label-card-other">IBM#:</span>
                        </div>
                        <div class="col-sm-7">
                          <span class="span-label-card-other1">{{company.ibmNumber}}</span>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-sm-5">
                          <span class="span-label-card-other">Tax ID#:</span>
                        </div>
                        <div class="col-sm-7">
                          <span class="span-label-card-other1">{{company.taxIdNumber}}</span>
                        </div>
                      </div>
                      <br />

                      <!-- INSURANCE EXPIRATION DATE BLOCK -->
                      <div class="row">
                        <div class="col-sm-12">
                          <span class="label-card"> DOB Insurance/Expiration Date</span>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-sm-5">
                          <span class="span-label-card-other">Work Compensation:</span>
                        </div>
                        <div class="col-sm-7">
                          <span class="span-label-card-other1">{{company.insuranceWorkCompensation}}</span>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-sm-5">
                          <span class="span-label-card-other">Disability:</span>
                        </div>
                        <div class="col-sm-7">
                          <span class="span-label-card-other1">{{company.insuranceDisability}}</span>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-sm-5">
                          <span class="span-label-card-other">General Liability:</span>
                        </div>
                        <div class="col-sm-7">
                          <span class="span-label-card-other1">{{company.insuranceGeneralLiability}}</span>
                        </div>
                      </div>
                      <br />
                      <!-- DOT INSURANCE EXPIRY BLOCK -->
                      <div class="row">
                        <div class="col-sm-12">
                          <span class="label-card"> DOT Insurance/Expiration Date</span>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-sm-5">
                          <span class="span-label-card-other">DOT Work Compensation:</span>
                        </div>
                        <div class="col-sm-7">
                          <span class="span-label-card-other1">{{company.dotInsuranceWorkCompensation}}</span>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-sm-5">
                          <span class="span-label-card-other">DOT General Liability:</span>
                        </div>
                        <div class="col-sm-7">
                          <span class="span-label-card-other1">{{company.dotInsuranceGeneralLiability}}</span>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-sm-5">
                          <span class="span-label-card-other">Street Obstruction Bond:</span>
                        </div>
                        <div class="col-sm-7">
                          <span class="span-label-card-other1">{{company.insuranceObstructionBond}}</span>
                        </div>
                      </div>

                    </div>
                  </div>
                  <div class="col-sm-4"></div>
                </div>

                <br />
                <!-- NOTES BLOCK -->
                <div class="row">
                  <div class="col-sm-12">
                    <span class="label-card"> Note:</span>
                  </div>
                </div>
                <div class="row">
                  <div class="col-sm-12">
                    <span class="notes">{{company.notes}}</span>
                  </div>
                </div>
                <div class="row">
                  <div class="col-sm-12 modify" *ngIf="company.lastModifiedByEmployeeName">
                    Last modified by {{company.lastModifiedByEmployeeName}} on {{company.lastModifiedDate |
                    date:'MM/dd/yyyy h:mm a'}}
                  </div>
                </div>
              </div>
            </div>
          </div>
        </ng-container>

        <ng-container *ngIf="ShowRFP">
          <div class="comp-rfp">
            <rfp-data-table [contactId]="rec.id" [srch]="queryString"></rfp-data-table>
          </div>
        </ng-container>

        <ng-container *ngIf="ShowJobs">
          <div class="comp-job">
            <job-data-table [contactId]="rec.id" [srch]="queryString"></job-data-table>
          </div>
        </ng-container>
      </div>

    </div>
  </div>

  <ng-template #formCompany>
    <div form-company [company]="company" [modalRef]="modalRef" [onSave]="onSave" [fromContactDetails]='true'></div>
  </ng-template>

  <ng-template #formContact>
    <div form-contact [contact]="rec" [modalRef]="modalRef" [onSave]="onSave"></div>
  </ng-template>

  <ng-template #formJob>
    <div form-job [job]="jobOfContact" [modalRefJob]="modalRef" [onSave]="onSave" [fromComp]="true"></div>
  </ng-template>
  <ng-template #addtask>
    <div add-task [addtask]="addtask" [isNew]="true" [idContact]="idContact" [modalRef]="modalRef" [reload]="reload">
    </div>
  </ng-template>
  <!-- View Create Send Email -->
  <ng-template #sendemail>
    <div send-email [sendemail]="sendemail" [modalRef]="modalRef" [idContact]="idContact"
      [idCompany]="idCompanyFromContact" [openFromContact]="true"></div>
  </ng-template>
  <div class="lds-css" *ngIf="loading">
    <div class="lds-ripple">
      <div></div>
      <div></div>
    </div>
  </div>
</ng-container>


<ng-container *ngIf="isCustomerLoggedIn">
  <div class="rpo-Company rpo-component">
    <div class="component-body">
      <div class="row" style="min-height: 100vh;display: flex;">
        <div class="col-md-12 text-center" style="margin: auto 0;">
          <h5>Customer Don't have access of this page!</h5>
        </div>
      </div>
    </div>
  </div>
</ng-container>